<html xmlns:o="urn:schemas-microsoft-com:office:office"
         xmlns:w="urn:schemas-microsoft-com:office:word"
         xmlns="http://www.w3.org/TR/REC-html40">内容来自：<a href="http://www.03964.com">文档资料库</a>http://www.03964.com/<br>更多"STM32F103 开发板原理图"相关资料请点击<a href="http://www.03964.com/search.php?q=STM32F103+%BF%AA%B7%A2%B0%E5%D4%AD%C0%ED%CD%BC">这里</a><p>STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
文件状态： [ ] 草稿 [√] 正式发布 [ ] 正在修改<br />
<br />
文件标识： 2007-12-19-V1.0 当前版本： V1.0 作 者： 黄盈鑫 完成日期： 2007-12-19<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 1 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
版本历史<br />
版本/状态 V1.0 作者/ 修改者 黄盈鑫 日期 2007-12-19 文件初始生成 说明<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 2 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
目 录<br />
1. 2. 概述 ..........................................................................................................................................5 电路及接口说明.......................................................................................................................5 2.1. 2.2. 2.3. 2.4. 2.5. 2.6. 2.7. 2.8. 2.9. 2.10. 2.11. 2.12. 2.13. 2.14. 2.15. 2.16. 2.17. 2.18. 2.19. 2.20. 3. 电源模块.......................................................................................................................5 时钟供电模块...............................................................................................................6 USB通信模块...............................................................................................................6 CAN通信模块 ..............................................................................................................7 RS232 通信模块...........................................................................................................7 红外通信模块...............................................................................................................8 SPI设备.........................................................................................................................9 IIC设备 .......................................................................................................................10 系统复位电路.............................................................................................................10 蜂鸣器驱动电路.........................................................................................................11 LED驱动电路.............................................................................................................12 按键扫描电路.............................................................................................................12 AD测试电路...............................................................................................................13 音频输入电路.............................................................................................................13 音频输出电路.............................................................................................................13 处理器工作方式配置电路.........................................................................................14 PWM电机接口 ...........................................................................................................15 液晶接口.....................................................................................................................16 智能卡接口.................................................................................................................17 扩展接口.....................................................................................................................17<br />
<br />
软件使用说明.........................................................................................................................18 3.1. KEIL编译环境.............................................................................................................18 3.1.1. 搭建编译环境 .........................................................................................................18 3.1.2. 配置编译环境 .........................................................................................................18 3.2. IAR编译环境..............................................................................................................20 3.2.1. 搭建编译环境 .........................................................................................................20 3.2.2. 配置编译环境 .........................................................................................................20<br />
<br />
4.<br />
<br />
应用程序下载说明.................................................................................................................20 4.1.1. 4.1.2.<br />
<br />
通过串口下载程序 .................................................................................................20 通过USB口下载程序 .............................................................................................23<br />
<br />
5.<br />
<br />
应用程序说明.........................................................................................................................24 5.1. CODE\KEIL目录下的程序说明................................................................................25 5.1.1. KEIL\STM32_GPIO................................................................................................25 5.1.2. KEIL\STM32_USART_Irq.......................................................................................26 5.1.3. KEIL\STM32_USBMem ..........................................................................................27 5.1.4. KEIL\others.............................................................................................................28 5.2. CODE\ ST32F10X目录下的程序说明.......................................................................28<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 3 / 30<br />
<br />
STM32F103-EVAL 用户手册 5.2.1. 5.2.2. 5.2.3. 5.2.4. 6. 7.<br />
<br />
www.elechome.com<br />
<br />
ST32F10x\STM32F10xFWLib ................................................................................28 ST32F10x\ STM32F10xUSBLib..............................................................................29 ST32F10x\ STM3210B-EVAL_Demo ......................................................................30 ST32F10x\ others ....................................................................................................30<br />
<br />
原理图 ....................................................................................................................................30 附录 ........................................................................................................................................30 7.1. 附录A 联系方式 ........................................................................................................30<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 4 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
1. 概述<br />
文档适合购买 STM32F103-EVAL 开发板的用户使用，希望通过文档的描述可以使用户 更快的进入产品的开发阶段。 开发板图片<br />
<br />
2. 电路及接口说明<br />
2.1. 电源模块<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 5 / 30<br />
<br />
STM32F103-EVAL 用户手册 说明： 输入：5V DC 输出：3.3V DC 输出端接 L1 会提高电源的质量。<br />
<br />
www.elechome.com<br />
<br />
2.2. 时钟供电模块<br />
<br />
说明： BT 为电池供电接口，板上有丝印标明正负极。 D3、D4 的作用是使板上供电和电池供电两种供电方式相互独立。<br />
<br />
2.3. USB 通信模块<br />
<br />
说明： 开发板可以通过 USB 接口供电，请不要同时使用 USB 和外接电源供电。 D+为高时 PC 认为有 USB 设备接上并要求安装驱动程序， 当只用 USB 接口供电而不用 USB 设备时 JP7 不接跳帽。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 6 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
2.4. CAN 通信模块<br />
<br />
说明：STB 接地为 normal 模式，R34 不焊接。<br />
<br />
2.5. RS232 通信模块<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 7 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
说明： D2、R29 为选择芯片的供电电源，板上 D2 焊接，切勿两个器件同时焊接，否则 5V 电 源会灌到 3.3V 供电电路上。 STM32F10x 的芯片的普通 IO 可以接受 5V 电平， 可选择价格相对便宜的 5V 供电的 232 芯片。 串口 3 带 CTS 和 RTS 控制。<br />
<br />
2.6. 红外通信模块<br />
<br />
说明：<br />
盈钰工作室技术文档 Page 8 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
红外接口与串口占用同一个串口， 通过 JP4、 跳针来选择， JP5 跳针接 1、 脚选择 RS232 2 接口，调制接 2、3 脚选择红外接口。 红外接口不焊接。<br />
<br />
2.7. SPI 设备<br />
<br />
说明： 板上配有三个 SPI 接口的设备，一个 SD 卡接口、一片 AT45DB041、一片 M25P64。 AT45DB041 和 M25P64 占用同一片选，即是同时只能用其一。<br />
盈钰工作室技术文档 Page 9 / 30<br />
<br />
STM32F103-EVAL 用户手册 AT45DB041 和 M25P64 不焊接。<br />
<br />
www.elechome.com<br />
<br />
2.8. IIC 设备<br />
<br />
说明： 板上配有两个 IIC 设备分别为存储器 AT24Cxx 温度传感器 LM75。 AT24Cxx 板上不焊接。<br />
<br />
2.9. 系统复位电路<br />
<br />
说明：开发板采用廉价的阻容复位电路。<br />
盈钰工作室技术文档 Page 10 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
2.10. 蜂鸣器驱动电路<br />
<br />
说明： 蜂鸣器为直流性质蜂鸣器，用户根据需要另行接上。 板上丝印为 BB 的 2PIN 单排针为蜂鸣器接口，靠近 JP3 丝印的为正极。 PE1 为低时蜂鸣器响。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 11 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
2.11. LED 驱动电路<br />
<br />
说明：PC6 为低时 LED 亮。<br />
<br />
2.12. 按键扫描电路<br />
<br />
说明： 按下按键时 PC13 为低，松开则为高。 按键的功能故名思义。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 12 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
2.13. AD 测试电路<br />
<br />
说明：R58 为 10K 精密电阻，PC4 口带 AD 功能可做简单的 AD 实验。<br />
<br />
2.14. 音频输入电路<br />
<br />
说明：该电路板上不焊接。<br />
<br />
2.15. 音频输出电路<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 13 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
说明：处理器将数字音频信号通过 PWM 方式转换为模拟音频信号，LM386 将音频信号放 大至扬声器。扬声器接口为两针单排针见上图，扬声器为普通 8 欧喇叭。<br />
<br />
2.16. 处理器工作方式配置电路<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 14 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
说明： 上图 PCB 文件 Boot Select 丝印下的‘0’和‘1’位置标错，需要互换，敬请留意。 SW1 的 2、3 脚，SW2 的 1、2 脚接上跳帽时用户可以通过串口下载程序。 SW1 的 2、3 脚，SW2 的 2、3 脚接上跳帽时下载到 Flash 中的程序运行。<br />
<br />
2.17. PWM 电机接口<br />
<br />
说明：电机控制板稍后推出，敬请留意。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 15 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
2.18. 液晶接口<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 16 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
说明： 开发板可接两种液晶屏，一为 320x240 分辨率的 TFT 屏，一为 128x64 分辨率的中文液 晶屏。 R19、R40 调液晶的灰度。TFT屏可以向笔者联系购买。<br />
<br />
2.19. 智能卡接口<br />
<br />
说明：智能卡接口板稍后推出，敬请留意。<br />
<br />
2.20. 扩展接口<br />
<br />
说明：开发板将处理器的所有 IO 都引出来方便用户调试，管脚定义详见上图。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 17 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
3. 软件使用说明<br />
3.1. Keil 编译环境 3.1.1. 搭建编译环境<br />
详见光盘完整版<br />
<br />
3.1.2. 配置编译环境<br />
打开其中的一个例子，点击“Options for Target”<br />
<br />
此时出现下列窗口：<br />
<br />
选择“Utilities”按下图选中“ULINK Cortex-M3 Debugger”。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 18 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
点击“Sattings”将会出现以下窗口，按显示内容配置。<br />
<br />
若“Programming Algorithm”框中没有显示对应芯片的参数信息，用户可以点击“Add” 添加对应芯片的编程参数。<br />
<br />
到此，用户可以点击“Dowmload to Flash Memory”通过ULINK2来下载程序了<br />
<br />
窗口中选中“Debug”按下图选中“ULINK Cortex-M3 Debugger” 在 “Options for Target”<br />
盈钰工作室技术文档 Page 19 / 30<br />
<br />
STM32F103-EVAL 用户手册 此时用户可以通过ULINK2来仿真程序了。<br />
<br />
www.elechome.com<br />
<br />
需要生成hex格式文件的用户请按下图设置，即是在“Create HEX File”上打上勾。<br />
<br />
3.2. IAR 编译环境 3.2.1. 搭建编译环境<br />
待续<br />
<br />
3.2.2. 配置编译环境<br />
待续<br />
<br />
4. 应用程序下载说明<br />
4.1.1. 通过串口下载程序<br />
运行光盘 Tool 目录下的 UM0462.exe 安装 STMicroelectronics Flash Loader。 SW1 的 2、3 脚，SW2 的 1、2 脚接上跳帽。 打开 STMicroelectronics Flash Loader。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 20 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
按“Next”进入串口配置，按下图方式设置串口参数。<br />
<br />
按下复位键，按“Next”进入芯片类型选择界面，按下图方式选择。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 21 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
按“Next”进入下载界面。 选中“Erase”按“Next”则进行程序擦除操作。 选中“Download”按下图设置，按“Next”则将程序下载到处理器上。<br />
<br />
将 SW1 的 2、3 脚，SW2 的 2、3 脚接上跳帽，按复位键，下载到 Flash 中的程序运行。<br />
盈钰工作室技术文档 Page 22 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
用户使用“串口调试助手.exe”等类似串口调试软件占用 PC 的同一个串口设备后 STMicroelectronics Flash Loader 不可以再使用，需要重新启动 PC。<br />
<br />
4.1.2. 通过 USB 口下载程序<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 23 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
5. 应用程序说明<br />
光盘中的应用程序分为只可以在 keil 编译环境下编译的程序和同时可以在 keil、IAR、 RIDE 三种编译环境下编译的程序。 只可以在 keil 编译环境下编译的程序存于光盘 CODE\KEIL 目录， 有关文件系统的代码 以 LIB 方式提供。三种编译环境都可以编译的程序存于光盘 CODE\ ST32F10x 目录，所有 程序以源代码方式提供。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 24 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
5.1. CODE\KEIL 目录下的程序说明<br />
<br />
5.1.1. KEIL\STM32_GPIO<br />
程序为简单的 LED 闪灯程序， 用户按 “WAKEUP” 按键时 LED 往右边闪， “TAMPER” 按 按钮时 LED 往左边闪。 用户可以打开 STM32_Init.c，在选项中设置 IO 口的属性，该功能较为实用敬请留意。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 25 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
5.1.2. KEIL\STM32_USART_Irq<br />
程序为串口 1 中断方式收发程序。 上电时超级终端提示输入字符， 用户按任一按键后超 级终端将键号打印出来。 主程序通过调用 stm32_Init 初始化系统参数其中也包括初始化串口 1，用户也可以打开 STM32_Init.c 进行图文方式配置。 中断服务程序的函数名称要与 STM32F10x.s 的中断向量表中的中断服务名称相同。 DCD USART1_IRQHandler ; USART1 void USART1_IRQHandler (void)<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 26 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
5.1.3. KEIL\STM32_USBMem<br />
USB 大容量存储类的应用程序。程序利用片内 RAM 做为存储区域，通过 USB 线接到 PC 时可以见到移动设备的盘符，进入该盘可以见到一文本文档。测试该程序时 JP7 要 接上跳帽。 usbdesc.c 中的 USB_DeviceDescriptor、USB_ConfigDescriptor 分别为设备描述符和配置 描述符， PC 通过这两种描述符获得设备信息和通信方式，任何一个 USB 从设备必须 具备这两种描述符。 由以下内容得知USB为批量传输方式，端点 1负责往PC端发送数据，端点 2负责接收PC 发送过来的数据，每次最多传送64个字节数据，数据传输方向相对PC而言。 USB_DEVICE_CLASS_STORAGE, /* bInterfaceClass */ MSC_SUBCLASS_SCSI, /* bInterfaceSubClass */ MSC_PROTOCOL_BULK_ONLY, /* bInterfaceProtocol */ 0x64, /* iInterface */ /* Bulk In Endpoint */ USB_ENDPOINT_DESC_SIZE, /* bLength */ USB_ENDPOINT_DESCRIPTOR_TYPE, /* bDescriptorType */ USB_ENDPOINT_IN(1), /* bEndpointAddress */ USB_ENDPOINT_TYPE_BULK, /* bmAttributes */ WBVAL(0x0040), /* wMaxPacketSize */ 0, /* bInterval */<br />
盈钰工作室技术文档 Page 27 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
/* Bulk Out Endpoint */ USB_ENDPOINT_DESC_SIZE, /* bLength */ USB_ENDPOINT_DESCRIPTOR_TYPE, /* bDescriptorType */ USB_ENDPOINT_OUT(2), /* bEndpointAddress */ USB_ENDPOINT_TYPE_BULK, /* bmAttributes */ WBVAL(0x0040), /* wMaxPacketSize */ 端点 1 和端点 2 的数据处理分别由 usbuser.c 中的 USB_EndPoint1 和 USB_EndPoint2 两 个函数执行。 CODE\ ST32F10x 目录下有 USB 接口使用 SD 卡储存文件的程序。<br />
<br />
5.1.4. KEIL\others<br />
待续<br />
<br />
5.2. CODE\ ST32F10x 目录下的程序说明<br />
<br />
5.2.1. ST32F10x\STM32F10xFWLib<br />
ST32F10x\STM32F10xFWLib\FWLib\examples 下有下图显示的共 70 个测试程序，用户 可以阅读 STM32F10xFWLib 目录下的 stm32lib_contents.htm 网页文件获得每个程序具 体功能。每个测试程序的文件夹内均有 readme.txt 文档，请参照文档的说明搭建编译环 境。<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 28 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
5.2.2. ST32F10x\ STM32F10xUSBLib<br />
ST32F10x\STM32F10xUSBLib\USBLib\demos 下有下图显示的 USB 设备相关的应用程 序，每个应用程序对应的 project\RVMDK 目录下保存 keil 编译器的工程文件。<br />
<br />
Audio_Speaker：USB 声卡类的应用程序。开发板通过 USB 线接到 PC，SP1 接上喇叭，<br />
盈钰工作室技术文档 Page 29 / 30<br />
<br />
STM32F103-EVAL 用户手册<br />
<br />
www.elechome.com<br />
<br />
PC 播放音频文件，喇叭播放音乐。 JoyStickMouse：USB HID 类的应用程序。开发板连接到 PC 时设备管理器窗口会显示 有人体输入输出设备接上。 Mass_Storage：USB 大容量存储类的应用程序。程序可操作 SD 卡相当于 U 盘使用，SD 卡使用前要格式化为 FAT 格式。 Virtual_COM_Port：USB HID 类的应用程序。相当于 USB 转串口设备使用，设备管理 器窗口上会添加多一个串口设备。 Device_Firmware_Upgrade： 相当于 USB 接口的 bootloader， 用户可以通过 DfuSeDemo.exe 来更新应用程序。<br />
<br />
5.2.3. ST32F10x\ STM3210B-EVAL_Demo<br />
该程序可以测试 320x240 分辨率的 FTF 屏，详见光盘完整版。<br />
<br />
5.2.4. ST32F10x\ others<br />
待续<br />
<br />
6. 原理图<br />
详见光盘完整版<br />
<br />
7. 附录<br />
7.1. 附录 A 联系方式<br />
网址：www.elechome.com 电子邮件：senxin79@126.com 电话：020-31708698 QQ：80635227 610374861<br />
<br />
盈钰工作室技术文档<br />
<br />
Page 30 / 30<br />
<br />
</p>内容来自：<a href="http://www.03964.com">文档资料库</a>http://www.03964.com/<br>更多"STM32F103 开发板原理图"相关资料请点击<a href="http://www.03964.com/search.php?q=STM32F103+%BF%AA%B7%A2%B0%E5%D4%AD%C0%ED%CD%BC">这里</a></html>